#!/usr/bin/env node
'use strict';
process.title = 'node-prompt';
const net = require('net');
const argv = require('yargs')
	.usage('Usage: $0 [options] <hostname>|<hostname:port>')
	.option('p', {
		alias: 'prompt',
		demand: false,
		default: '> ',
		describe: 'The prompt string to be used',
		type: 'string',
		nargs: 1
	})
	.example('$0 www.foobar.com:9000')
	.example('$0 foobar.com')
	.epilog('Port defaults to 43210')
	.argv;

const prompt = argv.prompt;
const [hostname, port = 43210] = argv._[0].split(':', 2);
if (!(+port >= 0) || !(+port <= 0xffff)) {
	console.error(clc.red('ERROR: %s is not a valid port number.'), port);
	process.exit(1);
}

var socket = net.connect(+port, hostname);
socket.on('connect', function () {
	require('../cli/controller')(socket, prompt);
});
socket.on('error', function (err) {
	console.error(clc.red(String(err)));
	process.exit(1);
});
